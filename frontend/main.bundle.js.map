{"version":3,"file":"main.bundle.js","mappings":";;;;;;;;;;AAAA,kD;;;;;;;;;;;ACAA,0C;;;;;;;;;;;ACAA,+B;;;;;;;;;;;ACAA,iC;;;;;;UCAA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;;;;;AC5BA,aAAa,mBAAO,CAAC,kBAAM;AAC3B,QAAQ,iDAAiD,EAAE,mBAAO,CAAC,0BAAU;AAC7E,QAAQ,QAAQ,EAAE,mBAAO,CAAC,oCAAe;;AAEzC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa,uCAAuC;AACpD,KAAK;AACL,IAAI;AACJ;AACA,eAAe,mBAAO,CAAC,cAAI;AAC3B;AACA;AACA;AACA;AACA,aAAa,gBAAgB;AAC7B;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA,sBAAsB,wFAA6C,IAAI,CAAkC;AACzG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA,IAAI,8CAAqC;AACzC,IAAI,CAA4B;AAChC,IAAI,CAAiD;AACrD;AACA,CAAC;;AAED;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,gBAAgB,mDAAmD;AACnE,GAAG;AACH;AACA,CAAC;;AAED;AACA;AACA,gBAAgB,mCAAmC;AACnD,GAAG;AACH;AACA,CAAC;;AAED;AACA;AACA,CAAC","sources":["webpack://strata/external commonjs2 \"require(\\\"electron\\\")\"","webpack://strata/external node-commonjs \"child_process\"","webpack://strata/external node-commonjs \"fs\"","webpack://strata/external node-commonjs \"path\"","webpack://strata/webpack/bootstrap","webpack://strata/./src/main.js"],"sourcesContent":["module.exports = require(\"require(\\\"electron\\\")\");","module.exports = require(\"child_process\");","module.exports = require(\"fs\");","module.exports = require(\"path\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Check if module exists (development only)\n\tif (__webpack_modules__[moduleId] === undefined) {\n\t\tvar e = new Error(\"Cannot find module '\" + moduleId + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","const path = require('path');\nconst { app, BrowserWindow, ipcMain, dialog, clipboard } = require('electron');\nconst { spawn } = require('child_process');\n\nlet mainWindow = null;\nlet backendProcess = null;\nlet windowShown = false;\n\nfunction getBackendPath() {\n  if (app.isPackaged) {\n    return path.join(process.resourcesPath, 'strata_backend');\n  }\n  return path.join(__dirname, '../../backend/dist/strata_backend');\n}\n\nfunction showWindowIfReady() {\n  if (windowShown || !mainWindow || mainWindow.isDestroyed()) return;\n  windowShown = true;\n  mainWindow.show();\n}\n\nfunction startBackend() {\n  if (app.isPackaged) {\n    const backendPath = getBackendPath();\n    backendProcess = spawn(backendPath, [], {\n      stdio: ['ignore', 'pipe', 'pipe'],\n      env: { ...process.env, PYTHONUNBUFFERED: '1' },\n    });\n  } else {\n    const repoRoot = path.join(__dirname, '../../..');\n    const fs = require('fs');\n    const venvUvicorn = path.join(repoRoot, '.venv', 'bin', 'uvicorn');\n    const uvicornCmd = fs.existsSync(venvUvicorn) ? venvUvicorn : 'uvicorn';\n    backendProcess = spawn(uvicornCmd, ['backend.main:app', '--host', '127.0.0.1', '--port', '8000'], {\n      cwd: repoRoot,\n      env: { ...process.env },\n      shell: uvicornCmd === 'uvicorn',\n    });\n  }\n\n  let buffer = '';\n  backendProcess.stdout.setEncoding('utf8');\n  backendProcess.stdout.on('data', (data) => {\n    const line = data.toString();\n    console.log('[backend]', line);\n    buffer += line;\n    const lines = buffer.split(/\\r?\\n/);\n    buffer = lines.pop() || '';\n    for (const l of lines) {\n      if (l.includes('Strata backend ready') && !windowShown) {\n        showWindowIfReady();\n      }\n    }\n  });\n\n  backendProcess.stderr.setEncoding('utf8');\n  backendProcess.stderr.on('data', (data) => {\n    console.error('[backend err]', data.toString());\n  });\n\n  backendProcess.on('error', (err) => {\n    console.error('Backend spawn error:', err);\n  });\n\n  backendProcess.on('exit', (code, signal) => {\n    backendProcess = null;\n  });\n\n  if (!app.isPackaged) {\n    setTimeout(() => {\n      if (!windowShown && mainWindow && !mainWindow.isDestroyed()) {\n        showWindowIfReady();\n      }\n    }, 10000);\n  }\n}\n\nfunction createWindow() {\n  const preloadPath = process.env.MAIN_WINDOW_PRELOAD_WEBPACK_ENTRY || path.join(__dirname, 'preload.js');\n  mainWindow = new BrowserWindow({\n    width: 1440,\n    height: 900,\n    minWidth: 1200,\n    minHeight: 800,\n    backgroundColor: '#000000',\n    titleBarStyle: 'hiddenInset',\n    show: false,\n    webPreferences: {\n      preload: preloadPath,\n      contextIsolation: true,\n      nodeIntegration: false,\n    },\n  });\n\n  mainWindow.on('closed', () => {\n    mainWindow = null;\n  });\n}\n\napp.whenReady().then(() => {\n  startBackend();\n  createWindow();\n\n  const loadUrl =\n    process.env.MAIN_WINDOW_WEBPACK_ENTRY ||\n    process.env.ELECTRON_DEV_URL ||\n    `file://${path.join(__dirname, '../index.html')}`;\n  mainWindow.loadURL(loadUrl).catch((err) => console.error(err));\n});\n\napp.on('window-all-closed', () => {\n  app.quit();\n});\n\napp.on('quit', () => {\n  if (backendProcess) {\n    backendProcess.kill();\n    backendProcess = null;\n  }\n});\n\nipcMain.handle('dialog:open', async () => {\n  const result = await dialog.showOpenDialog(mainWindow, {\n    properties: ['openFile'],\n    filters: [{ name: 'Models', extensions: ['pt', 'pth', 'onnx'] }],\n  });\n  return result;\n});\n\nipcMain.handle('dialog:save', async () => {\n  const result = await dialog.showSaveDialog(mainWindow, {\n    filters: [{ name: 'Text', extensions: ['txt'] }],\n  });\n  return result;\n});\n\nipcMain.handle('clipboard:write', async (_event, text) => {\n  clipboard.writeText(text);\n});\n"],"names":[],"sourceRoot":""}